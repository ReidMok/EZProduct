# ğŸ”§ è§£å†³æ•°æ®åº“è¿æ¥é”™è¯¯

## âš ï¸ é”™è¯¯

```
Error: P1001: Can't reach database server at `db.cugxiuizyhalmdxekged.supabase.co:5432`
```

## ğŸ” å¯èƒ½çš„åŸå› 

1. **å¯†ç  URL ç¼–ç é—®é¢˜**
   - ç‰¹æ®Šå­—ç¬¦å¯èƒ½æ²¡æœ‰æ­£ç¡®ç¼–ç 
   - æˆ–è€…ç¼–ç æ–¹å¼ä¸å¯¹

2. **Supabase æ•°æ®åº“æœªå¯ç”¨**
   - é¡¹ç›®å¯èƒ½è¿˜åœ¨åˆ›å»ºä¸­
   - æˆ–è€…æ•°æ®åº“è¢«æš‚åœ

3. **ç½‘ç»œè¿æ¥é—®é¢˜**
   - é˜²ç«å¢™é˜»æ­¢è¿æ¥
   - VPN å¹²æ‰°

## âœ… è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1ï¼šæ£€æŸ¥ Supabase é¡¹ç›®çŠ¶æ€

1. **è®¿é—® Supabase Dashboard**
   - æ‰“å¼€ï¼šhttps://supabase.com/dashboard
   - è¿›å…¥ä½ çš„é¡¹ç›® `EZProduct`

2. **æ£€æŸ¥é¡¹ç›®çŠ¶æ€**
   - ç¡®è®¤é¡¹ç›®çŠ¶æ€æ˜¯ "Active"ï¼ˆä¸æ˜¯ "Paused"ï¼‰
   - å¦‚æœè¢«æš‚åœï¼Œç‚¹å‡» "Resume" æ¢å¤

3. **æ£€æŸ¥æ•°æ®åº“è®¾ç½®**
   - ç‚¹å‡»å·¦ä¾§ "Settings" â†’ "Database"
   - ç¡®è®¤æ•°æ®åº“å·²åˆ›å»ºå®Œæˆ

### æ–¹æ¡ˆ 2ï¼šä½¿ç”¨ Supabase æä¾›çš„è¿æ¥å­—ç¬¦ä¸²

1. **åœ¨ Supabase Dashboard**
   - Settings â†’ Database
   - æ‰¾åˆ° "Connection string"
   - é€‰æ‹© "URI" æ ‡ç­¾
   - **ç›´æ¥å¤åˆ¶å®Œæ•´çš„è¿æ¥å­—ç¬¦ä¸²**ï¼ˆä¸è¦æ‰‹åŠ¨æ›¿æ¢å¯†ç ï¼‰

2. **ä½¿ç”¨å¤åˆ¶çš„è¿æ¥å­—ç¬¦ä¸²**
   ```bash
   DATABASE_URL="ç²˜è´´å®Œæ•´çš„è¿æ¥å­—ç¬¦ä¸²" npm run db:migrate
   ```

### æ–¹æ¡ˆ 3ï¼šæ£€æŸ¥å¯†ç ç¼–ç 

å¦‚æœ Supabase æä¾›çš„è¿æ¥å­—ç¬¦ä¸²æ ¼å¼æ˜¯ï¼š
```
postgresql://postgres:[YOUR-PASSWORD]@db.xxx.supabase.co:5432/postgres
```

ä½ éœ€è¦ï¼š
1. å°† `[YOUR-PASSWORD]` æ›¿æ¢ä¸ºå®é™…å¯†ç ï¼š`&hmB9!2_UK#7%?8`
2. ç„¶åå¯¹æ•´ä¸ªå¯†ç è¿›è¡Œ URL ç¼–ç 

**æˆ–è€…æ›´ç®€å•çš„æ–¹æ³•ï¼š**
- ç›´æ¥ä½¿ç”¨ Supabase Dashboard æä¾›çš„è¿æ¥å­—ç¬¦ä¸²
- å®ƒåº”è¯¥å·²ç»æ­£ç¡®ç¼–ç äº†

### æ–¹æ¡ˆ 4ï¼šä½¿ç”¨ Supabase SQL Editor åˆ›å»ºè¡¨

å¦‚æœè¿æ¥ä»ç„¶å¤±è´¥ï¼Œå¯ä»¥åœ¨ Supabase Dashboard ä¸­æ‰‹åŠ¨åˆ›å»ºè¡¨ï¼š

1. **æ‰“å¼€ SQL Editor**
   - åœ¨ Supabase Dashboard ä¸­ç‚¹å‡»å·¦ä¾§ "SQL Editor"

2. **è¿è¡Œä»¥ä¸‹ SQL**ï¼š
   ```sql
   -- åˆ›å»º Shop è¡¨
   CREATE TABLE "Shop" (
     "id" TEXT NOT NULL,
     "shop" TEXT NOT NULL,
     "accessToken" TEXT NOT NULL,
     "scope" TEXT NOT NULL,
     "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
     "updatedAt" TIMESTAMP(3) NOT NULL,
     CONSTRAINT "Shop_pkey" PRIMARY KEY ("id")
   );

   CREATE UNIQUE INDEX "Shop_shop_key" ON "Shop"("shop");
   CREATE INDEX "Shop_shop_idx" ON "Shop"("shop");

   -- åˆ›å»º ProductGeneration è¡¨
   CREATE TABLE "ProductGeneration" (
     "id" TEXT NOT NULL,
     "shopId" TEXT NOT NULL,
     "keywords" TEXT NOT NULL,
     "imageUrl" TEXT,
     "title" TEXT NOT NULL,
     "descriptionHtml" TEXT NOT NULL,
     "tags" TEXT NOT NULL,
     "seoTitle" TEXT,
     "seoDescription" TEXT,
     "variantsJson" TEXT NOT NULL,
     "shopifyProductId" TEXT,
     "shopifyProductHandle" TEXT,
     "status" TEXT NOT NULL DEFAULT 'pending',
     "errorMessage" TEXT,
     "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
     "updatedAt" TIMESTAMP(3) NOT NULL,
     CONSTRAINT "ProductGeneration_pkey" PRIMARY KEY ("id")
   );

   CREATE INDEX "ProductGeneration_shopId_idx" ON "ProductGeneration"("shopId");
   CREATE INDEX "ProductGeneration_status_idx" ON "ProductGeneration"("status");
   CREATE INDEX "ProductGeneration_createdAt_idx" ON "ProductGeneration"("createdAt");

   ALTER TABLE "ProductGeneration" ADD CONSTRAINT "ProductGeneration_shopId_fkey" FOREIGN KEY ("shopId") REFERENCES "Shop"("id") ON DELETE CASCADE ON UPDATE CASCADE;
   ```

3. **ç‚¹å‡» "Run" æ‰§è¡Œ SQL**

## ğŸ” è¯Šæ–­æ­¥éª¤

### 1. æµ‹è¯•æ•°æ®åº“è¿æ¥

åœ¨ Supabase Dashboard ä¸­ï¼š
- Settings â†’ Database
- ç‚¹å‡» "Test connection"
- çœ‹çœ‹æ˜¯å¦èƒ½æˆåŠŸè¿æ¥

### 2. æ£€æŸ¥é¡¹ç›®çŠ¶æ€

ç¡®è®¤é¡¹ç›®ï¼š
- çŠ¶æ€æ˜¯ "Active"
- æ•°æ®åº“å·²åˆ›å»ºå®Œæˆ
- æ²¡æœ‰æš‚åœæˆ–é™åˆ¶

### 3. ä½¿ç”¨ Supabase æä¾›çš„è¿æ¥å­—ç¬¦ä¸²

**é‡è¦**ï¼šä¸è¦æ‰‹åŠ¨ç¼–ç å¯†ç ï¼Œç›´æ¥ä½¿ç”¨ Supabase Dashboard æä¾›çš„è¿æ¥å­—ç¬¦ä¸²ï¼Œå®ƒåº”è¯¥å·²ç»æ­£ç¡®æ ¼å¼åŒ–äº†ã€‚

---

å…ˆæ£€æŸ¥ Supabase é¡¹ç›®çŠ¶æ€ï¼Œç„¶åä½¿ç”¨ Supabase Dashboard æä¾›çš„è¿æ¥å­—ç¬¦ä¸²é‡æ–°å°è¯•ï¼

